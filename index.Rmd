---
title: "ETC5521 Assignment 1"
subtitle: "Australian Animal Outcomes"
team: galah
author:
  - Sen Wang
  - Muhammad Soban Qasim
date: "`r Sys.Date()`"
bibliography: references.bib
biblio-style: authoryear-comp
output: 
  bookdown::html_document2
---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}


# Introduction and motivation

Animals are all around us in the sky, in the oceans, in our backyards and in our homes. What happens to animals in trouble, it could be cats, dogs, horses or livestock? Who takes care of them when they are in trouble or are lost? The answer is Royal Society for the Prevention of cruelty to Animals.  

The RSPCA is Australia's oldest, largest and most trusted animal welfare organization, according to its description, there is a gradual increase in the number of animals every year which are received in animal shelters and adoption centres across the country. RSPCA decides to analyse the results of animals in Australia and help them.


# Data description

There are three data tables separately coming from the RSPCA, Townsville Animal Complaints and Brisbane Open Data - Animal Complaints.

1. animal_outcomes.csv

*year*: Full year
*animal_type*: Animal type (horse, wildlife, dog, cat, etc)
*outcome*: 	Animal outcome - euthanized, released, rehomed, etc
*ACT*: ACT - Australian Capital Territory
*NSW*: New South Wales
*NT*: Northern Territory
*QLD*: Queensland
*SA*: South Australia
*TAS*: Tasmania
*VIC*: Victoria
*WA*: Western Australian
*Total*: Australian Total

2. animal_complaints.csv

*Animal Type*: Animal Type
*Complaint Type*: Complaint type
*Date Received*: Date received (Month - year)
*Suburb*: Suburb/region
*Electoral Division*: Electoral Division

3. brisbane_complaints.csv

*nature*:	Nature of complaints (animal)
*animal_type*: Animal type
*category*: Category of complaint
*suburb*: Suburb where reported
*date_range*: Date range (typically 1 quarter + year)
*responsible_office*: Responsible office for the complaint
*city*: City (Brisbane)


# Analysis and findings

[FILL] Should include at least one plot or numerical summary for each of your questions, that helps the reader arrive at an answer. You should also write paragraphs describing the methods, summaries and findings. 


 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, include = FALSE, message = FALSE, warning = FALSE)
```

```{r libraries}
library(tidytuesdayR)
library(tidyr)
library(ggplot2)
library(dplyr)
library(ggmap)
library(rgdal)
library(maptools)
library(plyr)
library(rgeos)
library(plotly)
library(mapproj)
library(leaflet)
library(tmaptools)
library(sf)
library(broom)
library(kableExtra)
```

```{r load-data}

tuesdata <- tidytuesdayR::tt_load(2020, week = 30) #downloading the data set as instructed in the git repo

animal_outcomes <- tuesdata$animal_outcomes  #seperating the data files for easier navigation
animal_complaints <- tuesdata$animal_complaints
brisbane_complaints <- tuesdata$brisbane_complaints

```

# Questions


## Q1: Which state has highest rate for the best possible outcome for animals?

```{r loading rds map}

aus_map <- readRDS("oz_map.rds") #loading the rds map file 

```

```{r calculating good outcomes}

q1 <- animal_outcomes %>% select(-year, 
                   -animal_type) %>% 
  group_by(outcome) %>% 
  summarise_at(vars(ACT, 
                    NSW, 
                    NT, 
                    QLD, 
                    SA, 
                    TAS, 
                    VIC, 
                    WA),  
               list( sum),na.rm=TRUE) #suming up the outcomes category wise




q11 <-  pivot_longer(q1, `ACT`:`WA`, 
                     names_to = "State", 
                     values_to = "outcomes") %>% 
  pivot_wider(names_from = outcome, 
              values_from = outcomes) #wranggling to get better visualizing sense

q11 <- q11 %>%  mutate(good_outcome = (rowSums(q11[,c(-1,-3)]))/rowSums(q11[,c(-1)])*100) #calculating percentage of good outcomes by taking out euthanization and dividing it by the total number of outcomes per state 

                                                                                                    q12 <- q11 %>% select(State, 
                                                                                                                         good_outcome)           #selecting variables for ease 
                                                                                                    
                                                                                                    
```


```{r getting the states up}
aus_map_states <- aus_map %>% 
  left_join(q12, by = c("state_abb" = "State")) #joining data sets by states

```

```{r Australian states with good outcome %, fig.height=8, fig.width=10, message=FALSE, warning=FALSE}
state_plot <- ggplot(aus_map_states,   #mapping our map
                     aes(x = longitude, 
                         y = latitude, 
                         fill = good_outcome)) + 
  geom_sf() + aes(x = longitude, 
                  y = latitude) +   
  labs(subtitle="Animals saved by RSPCA", 
       y=" ", 
       x=" ", 
       title="States with rates for the best possible outcome for animals", 
       caption = "Animal survival rate")+ 
  geom_sf_text(aes(label = state), 
               colour = "white")
  scale_fill_viridis_c( "alpha = 1",
  "begin = 0",
  "end = 100",
  "direction = 1",
  option = "D",
  values = NULL,
  space = "Lab",
  na.value = "black",
  guide = "colourbar",
  aesthetics = "fill"
) 
  
state_plot
```



## Q2: Which animal is euthanized the most throughout Australia?



```{r}
animal_outcomes  %>% group_by( year,
                 outcome, 
                 animal_type) %>%                         
  summarise_at(vars(ACT, 
                    NSW, 
                    NT, 
                    QLD, 
                    SA, 
                    TAS, 
                    VIC),  
               list( sum)) 

q2 <- animal_outcomes %>% filter(outcome == "Euthanized") %>% 
  select(animal_type, 
         ACT, 
         NSW, 
         NT, 
         QLD, 
         SA, 
         TAS, 
         VIC, 
         WA) %>%  
  group_by(animal_type) %>%                         
  summarise_at(vars(ACT, 
                    NSW, 
                    NT, 
                    QLD, 
                    SA, 
                    TAS, 
                    VIC, 
                    WA),            
               list(" " = sum)) 

q2$total_animals_euthanised = rowSums(q2[,c(-1)], na.rm=TRUE)
```

```{r,fig.height=8, fig.width=10}
options(scipen=999)
 p2 <- ggplot(q2,
              aes(x =reorder(animal_type, 
                             -total_animals_euthanised), 
                  y =  total_animals_euthanised)) + 
   geom_bar(stat="identity", 
            fill="tomato3") +   
   labs(subtitle="Which animal is the most euthanized", 
       y="Count", 
       x="Animals", 
       title="Australia Euthanization count", 
       caption = "Australia Euthanization rate") + 
  theme(axis.text.x = element_text(angle=45, vjust=0.9)) + 
   ylim(c(0, 600000)) 

ggplotly(p2)
```

## Q3: What is the percentage of rehomed animals state wise?

```{r Rehomed}
animal_outcomes2 <- animal_outcomes %>%
  filter(outcome == "Rehomed")


ACT_Rehomed_Ttl <- sum(animal_outcomes2$ACT)
NSW_Rehomed_Ttl <- sum(animal_outcomes2$NSW)
NT_Rehomed_Ttl <- sum(animal_outcomes2$NT, na.rm = TRUE)
QLD_Rehomed_Ttl <- sum(animal_outcomes2$QLD)
SA_Rehomed_Ttl <- sum(animal_outcomes2$SA)
TAS_Rehomed_Ttl <- sum(animal_outcomes2$TAS)
VIC_Rehomed_Ttl <- sum(animal_outcomes2$VIC)
WA_Rehomed_Ttl <- sum(animal_outcomes2$WA)
```

```{r Total}
ACT_Ttl <- sum(animal_outcomes$ACT)
NSW_Ttl <- sum(animal_outcomes$NSW)
NT_Ttl <- sum(animal_outcomes$NT, na.rm = TRUE)
QLD_Ttl <- sum(animal_outcomes$QLD)
SA_Ttl <- sum(animal_outcomes$SA, na.rm = TRUE)
TAS_Ttl <- sum(animal_outcomes$TAS, na.rm = TRUE)
VIC_Ttl <- sum(animal_outcomes$VIC)
WA_Ttl <- sum(animal_outcomes$WA)
```

```{r New_dataset}
d <- data.frame(
  State = c("ACT", 
            "NSW", 
            "NT", 
            "QLD", 
            "SA", 
            "TAS", 
            "VIC", 
            "WA"),
  Rehomed_Ttl = c(ACT_Rehomed_Ttl, 
                  NSW_Rehomed_Ttl, 
                  NT_Rehomed_Ttl, 
                  QLD_Rehomed_Ttl, 
                  SA_Rehomed_Ttl, 
                  TAS_Rehomed_Ttl, 
                  VIC_Rehomed_Ttl, 
                  WA_Rehomed_Ttl),
  Total = c(ACT_Ttl, 
            NSW_Ttl, 
            NT_Ttl, 
            QLD_Ttl, 
            SA_Ttl, 
            TAS_Ttl, 
            VIC_Ttl, 
            WA_Ttl)
)  %>%
  mutate(Percent = round(Rehomed_Ttl/Total*100))
```


```{r p1, fig.width = 8, fig.height = 8, fig.cap="The percentage of rehomed animals state wise", fig.align= "center"}
p1 <- ggplot(d, 
             aes(x=reorder(State,Percent), 
                 y=Percent)) +
  geom_histogram(stat="identity", 
                 fill = "lightblue", 
                 position = "dodge",
                 width= 0.8) +
  xlab("State") +
  ylab("Percentage") +
  ggtitle("The percentage of rehomed animals state wise")

ggplotly(p1)
```

In Figure  \@ref(fig:p1), it is clear that the highest proportion of animals were relocated in WA and the lowest proportion in QLD, but the difference between them is so much as only 13 percent.





## Q4: Cats Vs Dogs who are more likely to get adopted or reclaimed?
 

```{r screening}
animal_outcomes3 <- animal_outcomes %>%
  filter(outcome == "Reclaimed") %>%
  filter(animal_type == c("Dogs", "Cats"))
```

```{r p2, fig.width = 8, fig.height = 8, fig.cap="The more likely to get reclaimed", fig.align= "center"}
p2 <-  ggplot(animal_outcomes3, 
              aes( x = year,
              y = Total, 
              group = as.factor(animal_type),
              shape = as.factor(animal_type),
              colour = as.factor(animal_type))) +
  geom_line() +
  geom_point() +
  ggtitle("The more likely to get reclaimed") +
  theme(legend.title=element_blank())

ggplotly(p2)
```

In Figure  \@ref(fig:p2), from 1999 to 2018 the number of adopted cats has been stable, while the number of adopted cats has been fluctuated





# References
